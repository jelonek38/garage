<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monitor Garażu</title>
    <style>
        body { font-family: sans-serif; background: #0f172a; color: white; text-align: center; padding: 20px; }
        .card { background: #1e293b; padding: 20px; border-radius: 12px; margin: 10px; display: inline-block; min-width: 150px; border-top: 4px solid #38bdf8; }
        .val { font-size: 2.5rem; font-weight: bold; color: #38bdf8; display: block; }
        #debug-box { margin-top: 30px; background: #000; color: #fbbf24; padding: 15px; font-family: monospace; font-size: 11px; text-align: left; max-width: 600px; margin: 0 auto; border-radius: 8px; border: 1px solid #444; }
        .error-link { color: #f87171; text-decoration: underline; cursor: pointer; }
    </style>
</head>
<body>

    <h1>STATUS GARAŻU</h1>
    
    <div class="card"><span>RSSI</span><span id="rssi_v" class="val">--</span></div>
    <div class="card"><span>SNR</span><span id="snr_v" class="val">--</span></div>
    <div class="card"><span>PAKIET</span><span id="pakiet_v" class="val">--</span></div>

    <div id="debug-box">
        <strong>KONSOLA ANALITYCZNA:</strong><br>
        <div id="log-content">Czekam na start...</div>
    </div>

    <script>
        // SPRAWDŹ TO W "MY KEY" NA ADAFRUIT! 
        // Może być s_k_, s-k-, lub zupełnie inaczej.
        const USER = "S_K_"; 

        async function testConnection() {
            const feeds = ['rssi', 'snr', 'pakiet'];
            const logEl = document.getElementById('log-content');
            logEl.innerHTML = "";

            for (const f of feeds) {
                const url = `https://io.adafruit.com/api/v2/${USER}/feeds/${f}/data/last`;
                logEl.innerHTML += `Sprawdzam kanał: ${f}...<br>`;

                try {
                    const r = await fetch(url);
                    if (r.ok) {
                        const d = await r.json();
                        document.getElementById(f + '_v').innerText = d.value;
                        logEl.innerHTML += `<span style="color:#4ade80">✓ Sukces dla ${f}</span><br>`;
                    } else {
                        logEl.innerHTML += `<span style="color:#f87171">✗ BŁĄD ${r.status}. Kliknij i sprawdź czy link działa: <a class="error-link" href="${url}" target="_blank">LINK DO TESTU</a></span><br>`;
                    }
                } catch (e) {
                    logEl.innerHTML += `<span style="color:#f87171">✗ Błąd sieci: ${e.message}</span><br>`;
                }
            }
        }

        testConnection();
        setInterval(testConnection, 15000);
    </script>
</body>
</html>
